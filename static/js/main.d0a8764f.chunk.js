(this["webpackJsonpfrontend-challenge-yandex-map"]=this["webpackJsonpfrontend-challenge-yandex-map"]||[]).push([[0],{152:function(e,t,n){"use strict";(function(e){var a=n(43),r=n.n(a),o=n(76),c=n(9),s=n(79),i=n(80),l=n(85),d=n(84),u=n(0),p=n.n(u),m=n(167),h=n.n(m),f=n(77),g=n.n(f),y=(n(319),{cinema:{preset:"islands#redCinemaIcon"},club:{preset:"islands#greenNightClubIcon"},restaurant:{preset:"islands#blueFoodIcon"}}),b=function(t){Object(l.a)(a,t);var n=Object(d.a)(a);function a(){var t;Object(s.a)(this,a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=n.call.apply(n,[this].concat(o))).state={isReady:!1},t.getUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.apiKey,a=t.language,r={apiKey:n,lang:a};return"".concat(e,"?").concat(g.a.stringify(r))},t.mapLoaded=function(){return new Promise((function(n){t.ymaps=e.ymaps,t.ymaps.ready(n)}))},t.initMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.center,a=e.zoom;t.map=new t.ymaps.Map("map",{center:n,zoom:a},{searchControlProvider:"yandex#search"}),t.setState({isReady:!0})},t.setMapCenter=function(e){return t.map.setCenter(e)},t.generatePlacemarks=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var n=e.address,a=e.category,r=e.coordinates,o=e.name,s=e.description;return new t.ymaps.Placemark(r,{balloonContentHeader:o,balloonContentBody:s,balloonContentFooter:n,hintContent:o},Object(c.a)({preset:"islands#yellowStarIcon"},y[a]))}))},t.addPoints=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.map.geoObjects.removeAll(),t.generatePlacemarks(e).forEach((function(e){return t.map.geoObjects.add(e)}))},t}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h()(this.getUrl("https://api-maps.yandex.ru/2.1/",this.props),{returnPromise:!0});case 2:return e.next=4,this.mapLoaded();case 4:this.initMap(this.props);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){var t=this.props.center;e.center!==t&&this.setMapCenter(t),this.state.isReady&&this.addPoints(this.props.points)}},{key:"render",value:function(){return p.a.createElement("div",{id:"map",className:"map"})}}]),a}(u.Component);b.defaultProps={language:"ru_RU",points:[],zoom:10},t.a=b}).call(this,n(45))},183:function(e,t,n){e.exports=n(320)},193:function(e,t,n){},194:function(e,t,n){},195:function(e,t,n){},296:function(e,t,n){},319:function(e,t,n){},320:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(22),c=n.n(o),s=n(27),i=(n(192),n(193),n(194),n(328)),l=(n(195),function(e){var t=e.categories,n=e.handlers;return r.a.createElement("div",{className:"categories"},t.map((function(e){var t=e.id,a=e.name,o=e.selected;return r.a.createElement("div",{className:"category",key:t},r.a.createElement(i.a,{key:t,onChange:n.onToogleCategory.bind(void 0,t),checked:o,label:a}))})))});l.defaultProps={handlers:{},categories:[]};var d=l,u=n(24),p=n(43),m=n.n(p),h=n(76),f=n(54),g=n.n(f),y=n(77),b=n.n(y),v={API_KEY:"35831a5e-2de7-4646-90fe-69d7d1790945",MAP_CENTER:[55.76,37.64]},O={addPoint:function(e){return function(t){t({type:"ADD_POINT",payload:e})}},searchByAddress:function(e){return function(){var t=Object(h.a)(m.a.mark((function t(n){var a,r,o,c,s,i;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={apikey:v.API_KEY,geocode:e,format:"json"},r="".concat("https://geocode-maps.yandex.ru/1.x/","?").concat(b.a.stringify(a)),t.next=4,fetch(r);case 4:return o=t.sent,t.next=7,o.json();case 7:c=t.sent,s=g()(c,"response.GeoObjectCollection.featureMember")||[],i=s.map((function(e){return{coordinates:g()(e,"GeoObject.Point.pos").split(" ").map(parseFloat).reverse(),name:"".concat(g()(e,"GeoObject.name"),", ").concat(g()(e,"GeoObject.description"))}})),n({type:"SET_LOCATIONS",payload:i});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},clearSearchResults:function(){return function(e){e({type:"CLEAR_LOCATIONS"})}},setMapCenter:function(e){return function(t){t({type:"SET_MAP_CENTER",payload:e})}},toggleCategory:function(e){return function(t){t({type:"TOGGLE_CATEGORY",payload:e})}}},C=Object(s.b)((function(e){return{categories:e.categories}}),(function(e){return Object(u.b)({onToogleCategory:O.toggleCategory},e)}))((function(e){var t=e.children,n=e.categories,a=e.onToogleCategory;return r.a.cloneElement(t,{categories:n,handlers:{onToogleCategory:a}})})),E=n(111),j=n(78),S=n(9),w=n(79),A=n(80),P=n(85),k=n(84),M=n(159),R=n.n(M),T=n(321),N=n(333),_=n(332),I=n(329),x=n(334),F=n(330),B=n(331),G=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.forEach((function(e){return e&&e.apply(void 0,n)}))}},L=(n(296),function(e){Object(P.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).defaultState={address:"",category:null,coordinates:null,description:"",name:""},e.state=Object(S.a)(Object(S.a)({},e.defaultState),{},{showModal:!1}),e.button=r.a.createElement(T.a,{className:"add-button",color:"red"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0435"),e.toggleModal=function(){return e.setState((function(e){return{showModal:!e.showModal}}))},e.clearForm=function(){return e.setState(Object(S.a)({},e.defaultState))},e.setFormValue=function(t){return function(n,a){var r=a.value;return e.setState(Object(j.a)({},t,r))}},e.selectAddress=function(t){var n=t.coordinates,a=t.name;e.setState({coordinates:n,address:a}),e.props.handlers.onClearSearchResults()},e.searchByAddress=function(){var t=e.props.handlers,n=e.state.address;t.onSearchByAddress(n)},e.onSubmit=function(t){if(t.preventDefault(),e.isValid){var n=e.props.handlers,a=e.state,r=(a.showModal,Object(E.a)(a,["showModal"]));n.onAddPoint(r),n.onSetMapCenter(r.coordinates),e.toggleModal(),e.clearForm()}},e.searchByAddressDebounced=R()(e.searchByAddress,1e3),e}return Object(A.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.handlers,a=t.locations,o=this.state,c=o.address,s=o.category,i=o.description,l=o.name,d=o.showModal;return r.a.createElement(N.a,{size:"small",closeIcon:!0,open:d,onClose:this.toggleModal,onOpen:this.toggleModal,trigger:this.button},r.a.createElement(N.a.Content,null,r.a.createElement(_.a,{autoComplete:"off",className:"form",onSubmit:this.onSubmit},r.a.createElement(_.a.Field,{control:I.a,label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u044f",onChange:this.setFormValue("name"),value:l}),r.a.createElement(_.a.Field,{control:I.a,onChange:G(this.setFormValue("address"),this.searchByAddressDebounced,n.onClearSearchResults),label:"\u0410\u0434\u0440\u0435\u0441",value:c}),!!a.length&&r.a.createElement(x.a.Group,{className:"suggestions"},a.map((function(t){return r.a.createElement(x.a,{key:t.name,value:t.name,onClick:e.selectAddress.bind(e,t)},t.name)}))),r.a.createElement(_.a.Field,{control:F.a,label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",onChange:this.setFormValue("category"),options:this.categoryOptions,value:s}),r.a.createElement(_.a.Field,{control:B.a,label:"\u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",onChange:this.setFormValue("description"),rows:2,value:i}),r.a.createElement(T.a,{type:"submit"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}},{key:"categoryOptions",get:function(){return this.props.categories.map((function(e){var t=e.id;return{key:t,text:e.name,value:t}}))}},{key:"isValid",get:function(){var e=this.state,t=(e.showModal,Object(E.a)(e,["showModal"]));return Object.values(t).every((function(e){return!!e}))}}]),n}(a.Component));L.defaultProps={handlers:{},categories:[],locations:[]};var D=L,W=Object(s.b)((function(e){return{categories:e.categories,locations:e.locations}}),(function(e){return Object(u.b)({onAddPoint:O.addPoint,onClearSearchResults:O.clearSearchResults,onSearchByAddress:O.searchByAddress,onSetMapCenter:O.setMapCenter},e)}))((function(e){var t=e.children,n=e.categories,a=e.locations,o=e.onAddPoint,c=e.onClearSearchResults,s=e.onSearchByAddress,i=e.onSetMapCenter;return r.a.cloneElement(t,{categories:n,locations:a,handlers:{onAddPoint:o,onClearSearchResults:c,onSearchByAddress:s,onSetMapCenter:i}})})),U=n(152),V=Object(s.b)((function(e){return{categories:e.categories,center:e.mapCenter,points:e.points}}))((function(e){var t=e.children,n=e.categories,a=e.center,o=e.points,c=n.filter((function(e){return e.selected})).map((function(e){return e.id})),s=o.filter((function(e){var t=e.category;return c.includes(t)}));return r.a.cloneElement(t,{categories:n,center:a,points:s})})),K=n(168);var Y=function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"panel"},r.a.createElement(C,null,r.a.createElement(d,null)),r.a.createElement(W,null,r.a.createElement(D,null))),r.a.createElement("div",{className:"content"},r.a.createElement(V,null,r.a.createElement(U.a,{apiKey:K.API_KEY}))))},z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function J(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var H=n(170),$={categories:[{id:"club",name:"\u041a\u043b\u0443\u0431\u044b",selected:!0},{id:"restaurant",name:"\u0420\u0435\u0441\u0442\u043e\u0440\u0430\u043d\u044b",selected:!0},{id:"cinema",name:"\u041a\u0438\u043d\u043e\u0442\u0435\u0430\u0442\u0440\u044b",selected:!1}],locations:[],mapCenter:v.MAP_CENTER,points:[{coordinates:[55.833436,37.715175],name:"Night Club 1",address:"address here",description:"Some description....",category:"club"},{coordinates:[55.687086,37.529789],name:"Fast Food Restaurant",address:"address here",description:"Some description....",category:"restaurant"},{coordinates:[55.782392,37.614924],name:"Italian Restaurant",address:"address here",description:"Some description....",category:"restaurant"},{coordinates:[55.642063,37.656123],name:"CinemaPark",address:"address here",description:"Some description....",category:"cinema"},{coordinates:[55.826479,37.487208],name:"Night Club 2",address:"address here",description:"Some description....",category:"club"},{coordinates:[55.694843,37.435023],name:"Caro Premier",address:"address here",description:"Some description....",category:"cinema"},{coordinates:[55.790139,37.814052],name:"Night Club 3",address:"address here",description:"Some description....",category:"club"}]},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POINT":return Object(S.a)(Object(S.a)({},e),{},{points:[].concat(Object(H.a)(e.points),[t.payload])});case"SET_CATEGORIES":return Object(S.a)(Object(S.a)({},e),{},{categories:t.payload});case"CLEAR_CATEGORIES":return Object(S.a)(Object(S.a)({},e),{},{categories:$.list});case"SET_LOCATIONS":return Object(S.a)(Object(S.a)({},e),{},{locations:t.payload});case"CLEAR_LOCATIONS":return Object(S.a)(Object(S.a)({},e),{},{locations:$.locations});case"TOGGLE_CATEGORY":return Object(S.a)(Object(S.a)({},e),{},{categories:e.categories.map((function(e){return e.id!==t.payload?e:Object(S.a)(Object(S.a)({},e),{},{selected:!e.selected})}))});case"SET_MAP_CENTER":return Object(S.a)(Object(S.a)({},e),{},{mapCenter:t.payload});default:return e}},Q=n(169),X=Object(u.c)(q,Object(u.a)(Q.a));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,{store:X},r.a.createElement(Y,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/frontend-challenge-yandex-map",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/frontend-challenge-yandex-map","/service-worker.js");z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):J(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):J(t,e)}))}}()}},[[183,1,2]]]);
//# sourceMappingURL=main.d0a8764f.chunk.js.map